/* 2016-03-09 */ !function(){"use strict";var a={AUTH_REJECTED:"auth-rejected",AUTH_FORBIDDEN:"auth-forbidden"};angular.module("realtoner.auth",["realtoner.base","ngRoute"]).factory("csrfInterceptor",[function(){return{}}]).provider("httpWrapper",function(){var a={use:!1},b={useParameterMode:!0,givenCSRFTokenHeaderName:"X-CSRF-TOKEN",CSRFTokenParameterName:"_csrf",MethodUsingCSRF:{get:!1,post:!0,"delete":!1,head:!1}};this.setUseOAuth2Mode=function(b){a=!!b},this.setUseCSRFParameterMode=function(a){b.useParameterMode=!!a},this.setCSRFHeaderName=function(a){b.givenCSRFTokenHeaderName=a},this.setCSRFTokenParameterName=function(a){b.CSRFTokenParameterName=a},this.$get=["$http",function(a){return{}}]}).factory("authService",["$rootScope","httpBuffer",function(b,c){return{loginConfirmed:function(d,e){var f=e||function(a){return a};b.$broadcast("event:auth-loginConfirmed",d),c.retryAll(a.AUTH_REJECTED,f)},loginCancelled:function(d,e){c.rejectAll(a.AUTH_REJECTED,e),b.$broadcast("event:auth-loginCancelled",d)}}}]).factory("authInterceptor",["$rootScope","$q","httpBuffer",function(b,c,d){return{responseError:function(e){var f=e.config||{};if(!f.ignoreAuthModule){var g=c.defer();switch(e.status){case 401:return d.append(a.AUTH_REJECTED,f,g),b.$broadcast("event:auth-loginRequired",e),g.promise;case 403:d.append(a.AUTH_FORBIDDEN,f,g),b.$broadcast("event:auth-forbidden",e)}}return c.reject(e)}}}])}(),function(){"use strict";angular.module("realtoner.auth.csrf",[]).provider("csrfInterceptor",[function(){var a={useParameterMode:!0,givenCSRFTokenHeaderName:"X-CSRF-TOKEN",CSRFTokenParameterName:"_csrf",CSRFTokenHeaderName:"REQ-CSRF-TOKEN",methodUsingCSRF:{get:!1,post:!0,"delete":!1,head:!1}};this.setUseCSRFParameterMode=function(b){return a.useParameterMode=!!b,this},this.setCSRFHeaderNameFromResponse=function(b){return a.givenCSRFTokenHeaderName=b,this},this.setCSRFTokenParameterName=function(b){return a.CSRFTokenParameterName=b,this},this.setCSRFTokenHeaderName=function(a){return CSRFCOnfig.CSRFTokenHeaderName=a,this},this.setUseCSRFOnGet=function(b){return a.methodUsingCSRF.get=!!b,this},this.setUseCSRFOnPost=function(b){return a.methodUsingCSRF.post=!!b,this},this.setUseCSRFOnDelete=function(b){return a.methodUsingCSRF["delete"]=!!b,this},this.setUseCSRFOnHead=function(b){return a.methodUsingCSRF.head=!!b,this},this.$get=["$q",function(b){var c,d=function(b){var c=b.method.toLocaleLowerCase().trim();b.useCsrf=b.useCsrf||a.methodUsingCSRF[c],b.useHeaderMode=b.useHeaderMode||!a.useParameterMode,b.csrfParameterName=b.csrfParameterName||a.CSRFTokenParameterName,b.useHeaderMode&&(b.csrfHeaderName=b.useHeaderMode||a.CSRFTokenHeaderName)};return{request:function(a){return d(a),a.useCsrf&&(a.useHeaderMode?a.headers[a.csrfHeaderName]=c:(a.params=a.params||{},a.params[a.csrfParameterName]=c)),a},response:function(b){var d=b.headers(a.givenCSRFTokenHeaderName);return d&&(c=d),b},responseError:function(d){var e=d.headers(a.givenCSRFTokenHeaderName);return e&&(c=e),b.reject(d)}}}]}])}(),function(){"use strict";String.prototype.startsWith=function(){return 1==arguments.length?0===this.indexOf(arguments[0]):arguments.length>1&&"string"==typeof arguments[0]?0===arguments[0].indexOf(arguments[1]):!1},String.prototype.endsWith=function(){return 1==arguments.length?this.indexOf(arguments[0])===this.length-arguments[0].length:arguments.length>1?arguments[0].indexOf(arguments[1])===arguments[0].length-arguments[1].length:!1},angular.isPromise=function(a){return angular.isObject(a)&&a.then instanceof Function&&a["catch"]instanceof Function&&a["finally"]instanceof Function},angular.module("realtoner.base",["ngCookies"]).provider("httpRequester",[function(){var a={};this.setBaseUrl=function(b){a.url=b},this.$get=[function(){return null}]}]).provider("session",[function(){var a,b,c,d,e,f={},g={},h=0,i=function(){c=1e3*(f.defaultTimeout||36e3),d=1e3*(f.maxTimeout||72e3),e=f.sessionMaxSize||1024};this.setSessionDefaultTimeout=function(a){f.defaultTimeout=a},this.setSessionMaxTimeout=function(a){f.maxTimeout=a},this.setSessionMaxSize=function(a){f.sessionMaxSize=a},this.$get=["$timeout",function(f){function j(a,b,c,d){this.key=a,this.data=b,this.timeout=c,this.time=d}function k(a,b,c){this.pre=a,this.next=b,this.session=c}var l=function(a,b,c){return new j(a,b,f(function(){u(a)},c),c)},m=function(a,b,f){v(a),f=f?1e3*f:c,f>d&&(f=d),h>e&&s(),n(a,b,f)},n=function(a,b,c){var d=l(a,b,c);g[a]=d,d.queueUnit=o(d),p(d.queueUnit),h++},o=function(a){return new k(null,null,a)},p=function(c){a?(a.pre=c,c.next=a,c.pre=null,a=c):a=b=c},q=function(c){c.pre?c.pre.next=c.next:a=c.next,c.next?c.next.pre=c.pre:b=c.pre},r=function(a){q(a),p(a)},s=function(){for(var a=0,c=Math.floor(e/10),d=b;c>a&&d;)u(d.session.key),d=d.pre,d.next=null,b=d,a++},t=function(a){if(g[a]){var b=g[a];return f.cancel(b.timeout),b.timeout=f(function(){u(a)},b.time),r(b.queueUnit),b.data}},u=function(c){var d,e;d=g[c],e=d.queueUnit,f.cancel(d.timeout),e==a&&e==b?a=b=null:e==a?(a=e.next,a.pre=null):e==b?(b=e.pre,b.next=null):(e.pre.next=e.next,e.next.pre=e.pre),g[c]=null,h--},v=function(a){g[a]&&u(a)};return i(),{addData:m,addShortData:function(a,b){m(a,b,30)},getData:t,removeData:v,printQueue:function(){for(var b="",c=a;c;)b+="->"+c.session.key,c=c.next;return b}}}]}]).factory("httpBuffer",["$injector",function(a){var b,c={},d=function(c,d){function e(a){d.resolve(a)}function f(a){d.reject(a)}b=b||a.get("$http"),b(c).then(e,f)},e=function(a,b){if(a){b=b||function(a){return a};for(var c=0;c<a.length;c++)d(b(a[c].config),a[c].deferred)}},f=function(a,b){if(a&&b)for(var c=0;c<a.length;c++)a[c].deferred.reject(b)};return{append:function(a,b,d,e){var f=c[a]||[];f.push({config:b,deferred:d,token:e}),c[a]||(c[a]=f)},retryAll:function(a,b){var d=c[a];e(d,b),c[a]=[]},retryAllWithoutGivenToken:function(a,b,d){var f=c[a],g=[];if(f)for(var h=0;h<f.length;h++)f[h].token&&f[h].token===d||g.push(f[h].config,f[h].deferred);e(g,b),c[a]=[]},rejectAll:function(a,b){var d=c[a];f(d,b),c[a]=[]},rejectAllWithoutGivenToken:function(a,b,d){var e=c[a],g=[];if(e)for(var h=0;h<e.length;h++)e[h].token&&e[h].token===d||g.push(e[h].config,e[h].deferred);f(e,b),c[a]=[]}}}]).factory("dateUtil",[function(){return{convert:function(a){if(a instanceof Date)return new Date(a.toTime()+a.getTimezoneOffset());var b=new Date(a);return new Date(b.getTime()-1e3*b.getTimezoneOffset()*60)}}}])}(),function(){"use strict";angular.module("realtoner.directives",[]).directive("currentTime",function(a,b){function c(c,d,e){function f(){d.text(b(new Date,g))}var g,h;c.$watch(e.currentTime,function(a){g=a,f()}),d.on("$destroy",function(){a.cancel(h)}),h=a(function(){f()},1e3)}return{restrict:"A",link:c}}).directive("appSelectBar",function(){var a=function(a,b,c){a.getValue=function(){return"fuck"}};return{link:a,scope:{value:"="}}})}();